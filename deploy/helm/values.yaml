# Default values for bws-vault-bridge Helm chart.

replicaCount: 2

image:
  repository: ghcr.io/your-org/bws-vault-bridge
  pullPolicy: IfNotPresent
  tag: "latest"

nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: false
  name: ""

service:
  type: ClusterIP
  port: 3000

# Pod resource limits (per supplementary_specification.md ยง3 Performance)
resources:
  limits:
    memory: "256Mi"
    cpu: "500m"
  requests:
    memory: "128Mi"
    cpu: "100m"

# Environment variables
env:
  PORT: "3000"
  BWS_STATE_FILE: "/tmp/bws_state.json"
  CACHE_TTL: "60"
  LOG_LEVEL: "info"
  CIRCUIT_BREAKER_THRESHOLD: "5"
  CIRCUIT_BREAKER_COOLDOWN: "30"
  GATEWAY_AUTH_ENABLED: "true"

# Secret reference for BWS_ACCESS_TOKEN (must exist in the namespace)
existingSecret:
  name: "bws-vault-bridge-secret"
  key: "BWS_ACCESS_TOKEN"

# Probes
livenessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 15
  timeoutSeconds: 3
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /health?deep=true
    port: http
  initialDelaySeconds: 5
  periodSeconds: 10
  timeoutSeconds: 3
  failureThreshold: 2

# Network policy
networkPolicy:
  enabled: true
  # Only allow ingress from the APISix namespace
  allowedNamespaces:
    - apisix

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

securityContext:
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Node selector, tolerations, affinity
nodeSelector: {}
tolerations: []
affinity: {}
